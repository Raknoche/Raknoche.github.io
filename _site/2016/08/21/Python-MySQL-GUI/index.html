<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Making a MySQL GUI with Tkinter &middot; Dealing Data
    
  </title>

  <!-- Sidebar Icon Links-->
  <link rel="stylesheet" href="/fonts/font-awesome/css/font-awesome.min.css"> 
  <link rel="stylesheet" href="/fonts/cvFonts/styles.css"> 
  

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-81371278-1', 'auto');
  ga('send', 'pageview');

</script>

  <body>

    <div class="sidebar">
    <div class="sidebar-about">
      <h1>
          Dealing Data
      </h1>
    </div>

    <div class="sidebar-item">
      <p>A blog dedicated to learning data science techniques by applying them to real world data.</p>
    </div>


    <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/archive/">Archive</a>
          
        
      
        
      
        
          
        
      
        
          
        
      

      <!-- <a class="sidebar-nav-item" href=" http://www.github.com/raknoche ">GitHub Repo</a> -->
      <!-- <span class="sidebar-nav-item">Currently v1.0.0</span> -->

    <link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
  #mc_embed_signup{background:#202020; clear:left; font:14px Helvetica,Arial,sans-serif; }
  /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
     We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="//dealingdata.us13.list-manage.com/subscribe/post?u=194dacfdd7036fb11766517ff&amp;id=c0d39c54f6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
  <h2 class="subscribe">Subscribe to our mailing list</h2>
<div class="mc-field-group">
  <label for="mce-EMAIL">Email Address </label>
  <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
</div>
  <div id="mce-responses" class="clear">
    <div class="response" id="mce-error-response" style="display:none"></div>
    <div class="response" id="mce-success-response" style="display:none"></div>
  </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_194dacfdd7036fb11766517ff_c0d39c54f6" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button" style="color: #202020"></div>
  </div>
</form>
</div>

    </nav>

    <!-- <p>&copy; 2017. All rights reserved.</p> -->
    <div class="sidebar-item">
     <p class="social-icons">
       <a href="https://github.com/raknoche"><i class="fa fa-github fa-2x"></i></a>
       <a href="https://www.linkedin.com/in/richard-knoche-ba8bb1122"><i class="fa fa-linkedin fa-2x"></i></a>
       <a href="mailto:raknoche@dealingdata.net"><i class="fa fa-envelope fa-2x"></i></a>
       <a href="https://github.com/Raknoche/CV_and_Resume/blob/master/RichardKnoche_Resume.pdf"><i class="icon-roundcv fa-2x"></i></a>
      
     </p>
     <p>
       &copy; 2017. All rights reserved.
     </p>
   </div>
</div>



    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div>
      <div class="masthead">
        <div class="container-mast">
          <h3 class="masthead-title">
            <a href="/" title="Home">Dealing Data</a>
            <small>Learning data science through example</small>
          </h3>
        </div>
      </div>
      
      <div class="container content">
        <div class="post">
  <h1 class="post-title">Making a MySQL GUI with Tkinter</h1>
  <span class="post-date">21 Aug 2016</span>
  <div class="post-content">
  
    

<p>With the start of every school year comes a number of undergraduates interested in working in our physics lab.  In the past, new students had to learn how to interact with our MySQL databases before they could begin any data analysis.  This year, I decided to write a Python GUI that will make accessing and cleaning our data easier for new students.  The GUI will have a number of predefined query fields which the students can use to obtain data before saving that data to a local csv file. This approach will also reduce the number of students directly interacting with our MySQL database, and thereby reduce the risk of unintentional alterations to the data.</p>

<p>We’ll cover the following topics:</p>

<ol>
  <li><a href="#MySQL">Introduction to MySQL</a></li>
  <li><a href="#tkinter">Making a Python GUI with Tkinter</a></li>
  <li><a href="#queries">Sending Queries from our GUI</a></li>
  <li><a href="#saving">Saving data with our GUI</a></li>
</ol>

<h1 id="a-namemysqla-introduction-to-mysql"><a name="MySQL"></a> Introduction to MySQL</h1>

<p>MySQL is a free, open source <a href="https://en.wikipedia.org/wiki/Relational_database_management_system">Relational Database Management System</a> (RDBMS) that uses <a href="https://en.wikipedia.org/wiki/SQL">Structured Query Language</a> (SQL) to manage the content of various databases.  You can install a MySQL database on your own computer with a few simple steps.  If you’re a Mac or Linux user:</p>

<ol>
  <li>Download the latest DMG file from <a href="http://dev.mysql.com/downloads/mysql/">MySQL</a></li>
  <li>Use the DMG file to install MySQL on your computer</li>
  <li>Add the MySQL path to your system profile by typing <code class="highlighter-rouge">echo "export PATH=${PATH}:/usr/local/mysql/bin/" &gt;&gt; ~/.bash_profile</code> at the command line</li>
  <li>Configure a secure installation by typing <code class="highlighter-rouge">mysql_secure_installation</code> at the command line</li>
  <li>Start MySQL by clicking apple <script type="math/tex">\rightarrow</script> system preferences <script type="math/tex">\rightarrow</script>  MySQL <script type="math/tex">\rightarrow</script>  Start MySQL Server</li>
</ol>

<p>If you’re a Windows user, follow the installation directions on <a href="http://dev.mysql.com/downloads/windows/">MySQL’s website</a>.</p>

<p>You’ll also want to install the Python MySQL library.  This allows you to interact with a MySQL database through Python.  Installing the library is as simple as typing <code class="highlighter-rouge">pip install pymysql</code> at the command line.</p>

<p>If you’ve never used SQL, I suggest following <a href="https://sqlschool.modeanalytics.com">Mode Analytics’</a> or <a href="sqlzoo.net/wiki/SQL_Tutorial">SQLZoo’s</a> tutorials to familiarize yourself with the language.  You’ll be able to follow this post without doing so, but you’ll have trouble making a GUI for your own needs without knowledge of SQL.</p>

<h1 id="a-nametkintera-making-a-python-gui-with-tkinter"><a name="tkinter"></a> Making a Python GUI with Tkinter</h1>

<p>Python’s Tkinter library provides an easy to use interface to the Tk GUI toolkit.  We’ll be using it to build our customized GUI. To install Tkinter, type <code class="highlighter-rouge">pip install tkinter</code> at the command line.</p>

<p>Before we include any functionality in our GUI, lets build the basic layout.  First, we’ll need to create a Tk GUI window in Python.  We’ll pass this window to a customized class object (which I’m naming <code class="highlighter-rouge">App</code>) that will set up the layout of our GUI in its <code class="highlighter-rouge">__init__</code> method.  Note that in this post any code that belongs to the <code class="highlighter-rouge">__init__</code> method will be indicated by two indents, just as it would appear in our real Python code.  The <code class="highlighter-rouge">mainloop</code> method will open the window and display our GUI.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c">#We aren't using all of the libraries right now</span>
<span class="c">#but we will use them later in the post</span>

<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">pymysql</span> <span class="kn">as</span> <span class="nn">mdb</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">messagebox</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c">#Define a class to set up our GUI</span>
<span class="k">class</span> <span class="nc">App</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">):</span>
    	 <span class="c">#Set the window title</span>
        <span class="n">window</span><span class="o">.</span><span class="n">wm_title</span><span class="p">(</span><span class="s">"Database Interface"</span><span class="p">)</span>

<span class="c">#In our main function, create the GUI and pass it to our App class</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
	<span class="n">window</span><span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
	<span class="n">start</span><span class="o">=</span> <span class="n">App</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
	<span class="n">window</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>

<span class="c">#Run the main function</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre>
</div>

<p>Suppose our MySQL database contains data from a radioactivity counter.  The data table has the following columns</p>

<ul>
  <li><code class="highlighter-rouge">run_tag</code>: A string indicating a collection which the data belongs to</li>
  <li><code class="highlighter-rouge">clock_time</code>: A timestamp indicating when the radioactive decay occurred. Uses the format YYYY-MM-DD HH:MM:SS</li>
  <li><code class="highlighter-rouge">amplitude</code>: The energy of the observed decay</li>
</ul>

<p>We’d like to select data from the database by providing our GUI a run tag, a start time, an end time, or any combination of the three.  To do so, we’ll need to create some entry boxes in our GUI where the user can specify these parameters. I’ll refer to this section of our GUI as the “query panel.”</p>

<p>In the first row of our query panel, we’ll ask the user to specify a run tag.  We can create an empty class variable to store the run tag by using Tkinter’s <code class="highlighter-rouge">StringVar()</code> function.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>    	<span class="bp">self</span><span class="o">.</span><span class="n">runtag_text</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
</code></pre>
</div>

<p>To assign a string to the variable we use Tkinter’s <code class="highlighter-rouge">Entry</code> object, passing the variable we just created as the second argument.  This will display an entry box on our GUI that our user can type run tags into.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>    	<span class="bp">self</span><span class="o">.</span><span class="n">runtag_entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtag_text</span><span class="p">)</span>
</code></pre>
</div>

<p>To position the entry box on our GUI, we can use the <code class="highlighter-rouge">grid</code> method, specifying a row and a column.  For easy modification of the GUI code, I like to keep track of the current row using a <code class="highlighter-rouge">self.current_row</code> variable in the <code class="highlighter-rouge">App</code> class.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>    	<span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="o">=</span><span class="mi">0</span>
    	<span class="bp">self</span><span class="o">.</span><span class="n">runtag_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre>
</div>

<p>We’ll want display text on the GUI window that indicates the entry box we just created is to be used for run tags.  We can do so using Tkinter’s <code class="highlighter-rouge">Label</code> object.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>    	<span class="bp">self</span><span class="o">.</span><span class="n">runtag_label</span> <span class="o">=</span> <span class="n">Label</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span> <span class="s">"Run Tag: "</span><span class="p">)</span>
    	<span class="bp">self</span><span class="o">.</span><span class="n">runtag_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre>
</div>
<p>We can repeat this process for each of the three query parameters, incrementing the <code class="highlighter-rouge">self.current_row</code> by one for each new entry box.</p>

<p>At the bottom of our query panel, we’ll want to add a button that will submit the user’s query to our MySQL database.  I’ll discuss how to implement the functionality of this button later in the post, but for now we can place it on the GUI using Tkinter’s <code class="highlighter-rouge">Button</code> object.  We can indicate the purpose of the button by specifying the button’s text in the second argument of the <code class="highlighter-rouge">Button</code> method.  Since the button will be on a row by itself, we can place it in between column zero and column one by specifying a <code class="highlighter-rouge">columnspan</code> of two when we use the <code class="highlighter-rouge">grid</code> method.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>    	<span class="bp">self</span><span class="o">.</span><span class="n">query_button</span> <span class="o">=</span> <span class="n">Button</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">"Send Query"</span><span class="p">)</span>
    	<span class="bp">self</span><span class="o">.</span><span class="n">query_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre>
</div>

<p>Eventually, we’ll want the button to execute a method that we define in the <code class="highlighter-rouge">App</code> class.  Although we haven’t written it yet, we’ll call the method <code class="highlighter-rouge">sendQuery</code>.  We can make the button execute <code class="highlighter-rouge">sendQuery</code> when pressed by using the <code class="highlighter-rouge">configure</code> method.  I’ll leave this particular line commented out for now, since the <code class="highlighter-rouge">sendQuery</code> method doesn’t exist yet.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>    	<span class="c">#self.query_button.configure(command=self.sendQuery)</span>
</code></pre>
</div>

<p>We should also add a <code class="highlighter-rouge">Label</code> object underneath the query button that displays the status of our query after it is sent.  By default we’ll set the query status as an empty string.  After completing our query panel code, our <code class="highlighter-rouge">App</code> class will look like this:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">App</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">):</span>

        <span class="c">#Set the window title </span>
        <span class="n">window</span><span class="o">.</span><span class="n">wm_title</span><span class="p">(</span><span class="s">"Database Interface"</span><span class="p">)</span>
        
        <span class="c">#Set the current row to zero</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="o">=</span><span class="mi">0</span>
        
        <span class="s">'''Query Panel'''</span>
        <span class="c">#Run tag field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_label</span> <span class="o">=</span> <span class="n">Label</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span> <span class="s">"Run Tag: "</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_text</span>  <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtag_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c">#Start time field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_label</span> <span class="o">=</span> <span class="n">Label</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span> <span class="s">"Start Time (YYYY-MM-DD HH:MM:SS): "</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>          
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_text</span>  <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">start_t_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span>  <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="c">#End time field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_label</span> <span class="o">=</span> <span class="n">Label</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span> <span class="s">"End Time (YYYY-MM-DD HH:MM:SS): "</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>          
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_text</span>  <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end_t_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>     
        
        <span class="c">#Send Query button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query_button</span> <span class="o">=</span> <span class="n">Button</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">"Send Query"</span><span class="p">)</span>
        <span class="c">#self.query_button.command=self.sendQuery</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c">#Query status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">querystatus</span>  <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">''</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">querystatus</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre>
</div>

<p>If you run the main function at this point, it will produce the following (functionless) GUI.</p>

<p><img src="https://raw.githubusercontent.com/Raknoche/Raknoche.github.io/master/_posts/Images/GUI_QueryPanel.png" alt="png" class="center-image" /></p>

<h1 id="a-namequeriesa-sending-queries-from-our-gui"><a name="queries"></a> Sending queries from our GUI</h1>

<p>In this section, we’ll implement the <code class="highlighter-rouge">sendQuery</code> method that our query button will call when pressed.  For clarity, I’ll indent code that belongs in the <code class="highlighter-rouge">App</code> class with one tab, and code that belongs in the <code class="highlighter-rouge">sendQuery</code> method of the <code class="highlighter-rouge">App</code> class with two tabs.  Code that belongs outside of the <code class="highlighter-rouge">App</code> class will not be indented, just as it would not be in our Python code.</p>

<p>First, we define the new method within the <code class="highlighter-rouge">App</code> class.  Within the method, we can obtain any text that our user put in the entry boxes by using each variable’s <code class="highlighter-rouge">.get()</code> method.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>    <span class="k">def</span> <span class="nf">sendQuery</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">start_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_t_text</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">end_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_t_text</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">run_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtag_text</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</code></pre>
</div>

<p>Before we use any text that was entered, we need to verify that it is a valid string to use in our query.  We can use Python’s <a href="https://docs.python.org/2/library/re.html">regular expression</a> library to confirm that the start time and end time are in the YYYY-MM-DD HH:MM:SS format (if they were entered at all).  If the time parameters are in the correct format, we’ll also need to verify that the date specified is a valid date.  For instance, a start time of 2001-02-31 10:05:42 should be identified as a mistake since February does not have 31 days.  We can do so by trying to convert the string to a timestamp with <code class="highlighter-rouge">datetime.datetime</code>.  If the string is not a valid date, <code class="highlighter-rouge">datetime.datetime</code> will raise an exception which we can use to flag the date as being invalid.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>        <span class="c">#Check that date is valid</span>
        <span class="n">time_format</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'^</span><span class="err">\</span><span class="s">d{4}-</span><span class="err">\</span><span class="s">d{2}-</span><span class="err">\</span><span class="s">d{2} </span><span class="err">\</span><span class="s">d{2}:</span><span class="err">\</span><span class="s">d{2}:</span><span class="err">\</span><span class="s">d{2}$'</span><span class="p">)</span>
        <span class="n">start_t_okay</span><span class="o">=</span><span class="bp">None</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">start_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time_format</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">start_t</span><span class="p">)):</span>
            <span class="n">start_year</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">start_month</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span>
            <span class="n">start_day</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
            <span class="n">start_hour</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">13</span><span class="p">])</span>
            <span class="n">start_min</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">16</span><span class="p">])</span>
            <span class="n">start_sec</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">19</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span><span class="n">start_month</span><span class="p">,</span><span class="n">start_day</span><span class="p">,</span><span class="n">start_hour</span><span class="p">,</span><span class="n">start_min</span><span class="p">,</span><span class="n">start_sec</span><span class="p">)</span>
                <span class="n">start_t_okay</span><span class="o">=</span><span class="s">'yes'</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">start_t_okay</span><span class="o">=</span><span class="s">'no'</span>


        <span class="n">end_t_okay</span><span class="o">=</span><span class="bp">None</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">end_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time_format</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">end_t</span><span class="p">)):</span>
            <span class="n">end_year</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">end_month</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span>
            <span class="n">end_day</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
            <span class="n">end_hour</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">13</span><span class="p">])</span>
            <span class="n">end_min</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">16</span><span class="p">])</span>
            <span class="n">end_sec</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">19</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">end_year</span><span class="p">,</span><span class="n">end_month</span><span class="p">,</span><span class="n">end_day</span><span class="p">,</span><span class="n">end_hour</span><span class="p">,</span><span class="n">end_min</span><span class="p">,</span><span class="n">end_sec</span><span class="p">)</span>
                <span class="n">end_t_okay</span><span class="o">=</span><span class="s">'yes'</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">end_t_okay</span><span class="o">=</span><span class="s">'no'</span>
</code></pre>
</div>

<p>Now that we have determined if the start and end times are valid, we need to go through a list of possible errors before constructing our MySQL query.  Here’s everything that could go wrong:</p>

<ul>
  <li>The start time is not the correct format</li>
  <li>The end time is not the correct format</li>
  <li>The start time is not a valid date</li>
  <li>The end time is not a valid date</li>
  <li>The start time doesn’t come before the end time</li>
  <li>The run tag doesn’t exist in our database</li>
</ul>

<p>If any of these failure modes occur, we’ll want to display a message to the user to inform them of the mistake.  We can do so using Tkinter’s <code class="highlighter-rouge">messagebox.showinfo</code> method.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>        <span class="s">'''Error Handling'''</span>
        <span class="c">#Check that the date is in the correct format</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">start_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">time_format</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">start_t</span><span class="p">)):</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Error: Start time Must have the format "YYYY-MM-DD HH:MM:SS" or be empty'</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">end_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">time_format</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">end_t</span><span class="p">)):</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Error: End time Must have the format "YYYY-MM-DD HH:MM:SS" or be empty'</span><span class="p">)</span>
        <span class="c">#Check that the date is a valid date</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">start_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">start_t_okay</span> <span class="o">==</span> <span class="s">'no'</span><span class="p">):</span>        
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Error: Start time is not valid'</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">end_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_t_okay</span> <span class="o">==</span> <span class="s">'no'</span><span class="p">):</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Error: End time is not valid'</span><span class="p">)</span>
        <span class="c">#Check that start_t &lt; end_t</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">start_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">start_t</span> <span class="o">&gt;</span> <span class="n">end_t</span><span class="p">):</span>         
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Start time must come before end time'</span><span class="p">)</span>    
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Construct and send the query</span>
</code></pre>
</div>

<p>You may have noticed we did not check if the specified run tag exists in our database.  Assuming our data is stored in a table named <code class="highlighter-rouge">summarydata</code>, we could get a list of all of the run tags by sending a <code class="highlighter-rouge">SELECT DISTINCT(run_tag) FROM summarydata</code> query to the database.  This query scans the entire database to collect a list of every run tag, so it can take a while to run.  Instead of explicitly checking this condition, it would be more efficient to send the query with a nonexistent run tag and inform the user that the query did not return any data.  We’ll implement this later in the code.</p>

<p>Now that we’ve ensured our user has entered valid text, we need to build a MySQL query using that text.  It’s possible our user didn’t place any text in the entry boxes at all, in which case our MySQL query should default to collecting all the data in our database.  The syntax for this query would be</p>

<div class="language-sql highlighter-rouge"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">clock_time</span><span class="p">,</span> <span class="n">amplitude</span> <span class="k">FROM</span> <span class="n">summarydata</span> <span class="k">WHERE</span> <span class="n">amplitude</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span>
</code></pre>
</div>

<p>The <code class="highlighter-rouge">IS NOT NULL</code> ensures we do not collect data from our table if the energy record of an event is missing.  Regardless of whether we actually have missing energy data, we should still include the <code class="highlighter-rouge">IS NOT NULL</code> condition for another reason — it allows us to add additional conditions to our query with <code class="highlighter-rouge">AND</code> statements.  For instance, if our user provides a start time and end time in the entry boxes, our query would become</p>

<div class="language-sql highlighter-rouge"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">clock_time</span><span class="p">,</span> <span class="n">amplitude</span> <span class="k">FROM</span> <span class="n">summarydata</span> <span class="k">WHERE</span> <span class="n">amplitude</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">AND</span> <span class="n">clock_time</span> <span class="k">BETWEEN</span> <span class="n">start_time</span> <span class="k">AND</span> <span class="n">end_time</span>
</code></pre>
</div>

<p>If we did not have the <code class="highlighter-rouge">IS NOT NULL</code> condition in our default query, we would have to determine which query condition was first, and only add <code class="highlighter-rouge">AND</code> to the subsequent conditions.</p>

<p>To include conditional statements in our MySQL query, we will start with empty strings which represent the time and run tag conditions of our query.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>        <span class="c">#error checking was done up here</span>
		
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Default to not including the conditions in the query</span>
            <span class="n">run_tag_string</span> <span class="o">=</span> <span class="s">''</span>
            <span class="n">time_string</span> <span class="o">=</span> <span class="s">'''
</span></code></pre>
</div>

<p>If text was entered in an entry box, we change the corresponding condition string to a MySQL condition, such as <code class="highlighter-rouge">time_string = 'AND clock_time &gt; start_t'</code>.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>            <span class="c">#Toggle query conditions on if the GUI field isn't blank</span>
	    
            <span class="c">#Run tag condition</span>
            <span class="k">if</span> <span class="n">run_tag</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
                <span class="n">run_tag_string</span> <span class="o">=</span> <span class="s">'AND run_tag = "</span><span class="si">%</span><span class="s">s"'</span> <span class="o">%</span><span class="p">(</span><span class="n">run_tag</span><span class="p">)</span>
	        
            <span class="c">#Time window condition (in order: both set, only start set, only end set)</span>
            <span class="k">if</span> <span class="n">start_t</span> <span class="o">!=</span> <span class="s">''</span> <span class="ow">and</span> <span class="n">end_t</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
                <span class="n">time_string</span> <span class="o">=</span> <span class="s">'AND clock_time BETWEEN "</span><span class="si">%</span><span class="s">s" AND "</span><span class="si">%</span><span class="s">s"'</span> <span class="o">%</span><span class="p">(</span><span class="n">start_t</span><span class="p">,</span><span class="n">end_t</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">start_t</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
                <span class="n">time_string</span> <span class="o">=</span> <span class="s">'AND clock_time &gt; "</span><span class="si">%</span><span class="s">s"'</span> <span class="o">%</span><span class="p">(</span><span class="n">start_t</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">end_t</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
                <span class="n">time_string</span> <span class="o">=</span> <span class="s">'AND clock_time &lt; "</span><span class="si">%</span><span class="s">s"'</span> <span class="o">%</span><span class="p">(</span><span class="n">end_t</span><span class="p">)</span>    
</code></pre>
</div>

<p>Once we have determined the additional conditions to add to our default query, we simply append them to our original string to produce the final MySQL query.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>            <span class="c">#Setting the query</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="s">"SELECT clock_time, amplitude FROM summarydata WHERE amplitude IS NOT NULL </span><span class="si">%</span><span class="s">s </span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">run_tag_string</span><span class="p">,</span> <span class="n">time_string</span><span class="p">)</span>
</code></pre>
</div>

<p>To send the query to our MySQL database, we need to import the PyMySQL library at the top of our code.  We can use the <code class="highlighter-rouge">connect</code> method of the PyMySQL library to open a connection to our database.  We need to provide an IP address, a username, a password, and a database name for the connection to work.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>            <span class="n">con</span> <span class="o">=</span> <span class="n">mdb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pswd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="p">);</span>
</code></pre>
</div>

<p>It would be a security risk to include this information in the code itself, so instead we’ll need to have each item passed into our program as a command line argument, and in turn pass them into our <code class="highlighter-rouge">App</code> class.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">App</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">user</span><span class="p">,</span><span class="n">pswd</span><span class="p">,</span><span class="n">db</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="o">=</span><span class="n">ip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">=</span><span class="n">user</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pswd</span><span class="o">=</span><span class="n">pswd</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">=</span><span class="n">db</span>
		
        <span class="c">#Rest of class code goes here...</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="s">'''
    Usage: python radonGUI.py databaseIP username password databaseTable
    '''</span>

    <span class="n">ip</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">pswd</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

    <span class="n">window</span><span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
    <span class="n">start</span><span class="o">=</span> <span class="n">App</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">user</span><span class="p">,</span><span class="n">pswd</span><span class="p">,</span><span class="n">db</span><span class="p">)</span>
    <span class="n">window</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
</code></pre>
</div>

<p>Once our MySQL connection is established, we create a <code class="highlighter-rouge">cursor</code> object which we’ll use to interact with the database.  We tell the cursor to execute our MySQL query using the <code class="highlighter-rouge">execute</code> method, and we can fetch the return of the query using the <code class="highlighter-rouge">cur.fetchall()</code> method.  The data is returned as a tuple of tuples, with the outer tuple representing the row of the data table and the inner tuple representing the column.  It’s convenient to store the data in a Pandas data frame, which we can easily do using list comprehensions.  Note that the timestamp from our database is returned in the <code class="highlighter-rouge">YYYY-MM-DD HH:MM:SS</code> format, so we should use the <code class="highlighter-rouge">mktime</code> method from Python’s time library to convert it to a more convenient unix timestamp.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>            <span class="k">with</span> <span class="n">con</span><span class="p">:</span>
                <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
			
                <span class="c">#Send select statement</span>
                <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">)</span>
			
                <span class="c">#Fetch the data from our query</span>
                <span class="n">rows</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
			
                <span class="c">#Fill a pandas data frame with timestamps and amplitude info</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timetuple</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">))]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s">'amplitude'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">))]</span>
</code></pre>
</div>

<p>Once our query is complete, we should update the query status label to inform our user that we have finished collecting all the data.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>            <span class="bp">self</span><span class="o">.</span><span class="n">querystatus</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s">"Finished"</span><span class="p">)</span>
</code></pre>
</div>

<p>Finally, we should check to see if our query actually returned data from out database.  If the data frame is empty, we should display a warning to our user that no data was collected from the query.  Note that this will also handle any issues with nonexistent run tags that our user may have entered earlier.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>            <span class="c">#Check if the query returned data</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                 <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Warning'</span><span class="p">,</span> <span class="s">'Warning: Query returned no data'</span><span class="p">)</span>
</code></pre>
</div>

<p>Now that we have a working <code class="highlighter-rouge">sendQuery</code> method, we need to uncomment the line which assigns the <code class="highlighter-rouge">sendQuery</code> method to our query button.  Our entire code now looks like this:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">pymysql</span> <span class="kn">as</span> <span class="nn">mdb</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">messagebox</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">class</span> <span class="nc">App</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">user</span><span class="p">,</span><span class="n">pswd</span><span class="p">,</span><span class="n">db</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="o">=</span><span class="n">ip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">=</span><span class="n">user</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pswd</span><span class="o">=</span><span class="n">pswd</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">=</span><span class="n">db</span>

        <span class="c">#Set the window title </span>
        <span class="n">window</span><span class="o">.</span><span class="n">wm_title</span><span class="p">(</span><span class="s">"Database Interface"</span><span class="p">)</span>

        <span class="c">#Set the current row to zero</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="o">=</span><span class="mi">0</span>

        <span class="s">'''Query Panel'''</span>
        <span class="c">#Run tag field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_label</span> <span class="o">=</span> <span class="n">Label</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span> <span class="s">"Run Tag: "</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_text</span>  <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtag_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c">#Start time field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_label</span> <span class="o">=</span> <span class="n">Label</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span> <span class="s">"Start Time (YYYY-MM-DD HH:MM:SS): "</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>          
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_text</span>  <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">start_t_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span>  <span class="o">+=</span> <span class="mi">1</span>

        <span class="c">#End time field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_label</span> <span class="o">=</span> <span class="n">Label</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span> <span class="s">"End Time (YYYY-MM-DD HH:MM:SS): "</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>          
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_text</span>  <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end_t_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>     

        <span class="c">#Send Query button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query_button</span> <span class="o">=</span> <span class="n">Button</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">"Send Query"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query_button</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sendQuery</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c">#Query status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">querystatus</span>  <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">''</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">querystatus</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">sendQuery</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">start_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_t_text</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">end_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_t_text</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">run_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtag_text</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

        <span class="c">#Check that date is valid</span>
        <span class="n">time_format</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'^</span><span class="err">\</span><span class="s">d{4}-</span><span class="err">\</span><span class="s">d{2}-</span><span class="err">\</span><span class="s">d{2} </span><span class="err">\</span><span class="s">d{2}:</span><span class="err">\</span><span class="s">d{2}:</span><span class="err">\</span><span class="s">d{2}$'</span><span class="p">)</span>
        <span class="n">start_t_okay</span><span class="o">=</span><span class="bp">None</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">start_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time_format</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">start_t</span><span class="p">)):</span>
            <span class="n">start_year</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">start_month</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span>
            <span class="n">start_day</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
            <span class="n">start_hour</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">13</span><span class="p">])</span>
            <span class="n">start_min</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">16</span><span class="p">])</span>
            <span class="n">start_sec</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">19</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span><span class="n">start_month</span><span class="p">,</span><span class="n">start_day</span><span class="p">,</span><span class="n">start_hour</span><span class="p">,</span><span class="n">start_min</span><span class="p">,</span><span class="n">start_sec</span><span class="p">)</span>
                <span class="n">start_t_okay</span><span class="o">=</span><span class="s">'yes'</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">start_t_okay</span><span class="o">=</span><span class="s">'no'</span>


        <span class="n">end_t_okay</span><span class="o">=</span><span class="bp">None</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">end_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time_format</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">end_t</span><span class="p">)):</span>
            <span class="n">end_year</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">end_month</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span>
            <span class="n">end_day</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
            <span class="n">end_hour</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">13</span><span class="p">])</span>
            <span class="n">end_min</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">16</span><span class="p">])</span>
            <span class="n">end_sec</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">19</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">end_year</span><span class="p">,</span><span class="n">end_month</span><span class="p">,</span><span class="n">end_day</span><span class="p">,</span><span class="n">end_hour</span><span class="p">,</span><span class="n">end_min</span><span class="p">,</span><span class="n">end_sec</span><span class="p">)</span>
                <span class="n">end_t_okay</span><span class="o">=</span><span class="s">'yes'</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">end_t_okay</span><span class="o">=</span><span class="s">'no'</span>        

        <span class="s">'''Error Handling'''</span>
        <span class="c">#Check that the date is in the correct format</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">start_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">time_format</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">start_t</span><span class="p">)):</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Error: Start time Must have the format "YYYY-MM-DD HH:MM:SS" or be empty'</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">end_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">time_format</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">end_t</span><span class="p">)):</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Error: End time Must have the format "YYYY-MM-DD HH:MM:SS" or be empty'</span><span class="p">)</span>
        <span class="c">#Check that the date is a valid date</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">start_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">start_t_okay</span> <span class="o">==</span> <span class="s">'no'</span><span class="p">):</span>        
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Error: Start time is not valid'</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">end_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_t_okay</span> <span class="o">==</span> <span class="s">'no'</span><span class="p">):</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Error: End time is not valid'</span><span class="p">)</span>
        <span class="c">#Check that start_t &lt; end_t</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">start_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">start_t</span> <span class="o">&gt;</span> <span class="n">end_t</span><span class="p">):</span>         
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Start time must come before end time'</span><span class="p">)</span>    
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Default to not including the conditions in the query</span>
            <span class="n">run_tag_string</span> <span class="o">=</span> <span class="s">''</span>
            <span class="n">time_string</span> <span class="o">=</span> <span class="s">''</span>

            <span class="c">#Toggle query conditions on if the GUI field isn't blank</span>

            <span class="c">#Run tag condition</span>
            <span class="k">if</span> <span class="n">run_tag</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
                <span class="n">run_tag_string</span> <span class="o">=</span> <span class="s">'AND run_tag = "</span><span class="si">%</span><span class="s">s"'</span> <span class="o">%</span><span class="p">(</span><span class="n">run_tag</span><span class="p">)</span>
                
            <span class="c">#Time window condition (in order: both set, only start set, only end set)</span>
            <span class="k">if</span> <span class="n">start_t</span> <span class="o">!=</span> <span class="s">''</span> <span class="ow">and</span> <span class="n">end_t</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
                <span class="n">time_string</span> <span class="o">=</span> <span class="s">'AND clock_time BETWEEN "</span><span class="si">%</span><span class="s">s" AND "</span><span class="si">%</span><span class="s">s"'</span> <span class="o">%</span><span class="p">(</span><span class="n">start_t</span><span class="p">,</span><span class="n">end_t</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">start_t</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
                <span class="n">time_string</span> <span class="o">=</span> <span class="s">'AND clock_time &gt; "</span><span class="si">%</span><span class="s">s"'</span> <span class="o">%</span><span class="p">(</span><span class="n">start_t</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">end_t</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
                <span class="n">time_string</span> <span class="o">=</span> <span class="s">'AND clock_time &lt; "</span><span class="si">%</span><span class="s">s"'</span> <span class="o">%</span><span class="p">(</span><span class="n">end_t</span><span class="p">)</span>           
                            
            <span class="c">#Setting the query</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="s">"SELECT clock_time, amplitude FROM summarydata WHERE amplitude IS NOT NULL </span><span class="si">%</span><span class="s">s </span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">run_tag_string</span><span class="p">,</span> <span class="n">time_string</span><span class="p">)</span>

            <span class="n">con</span> <span class="o">=</span> <span class="n">mdb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pswd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="p">);</span>

            <span class="k">with</span> <span class="n">con</span><span class="p">:</span>
                <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

                <span class="c">#Send select statement</span>
                <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">)</span>

                <span class="c">#Fetch the data from our query</span>
                <span class="n">rows</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

                <span class="c">#Fill a pandas data frame with timestamps and amplitude info</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timetuple</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">))]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s">'amplitude'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">))]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">querystatus</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s">"Finished"</span><span class="p">)</span>

            <span class="c">#Check if the query returned data</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                 <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Warning'</span><span class="p">,</span> <span class="s">'Warning: Query returned no data'</span><span class="p">)</span>
           

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="s">'''
    Usage: python radonGUI.py databaseIP username password databaseTable
    '''</span>
    <span class="n">ip</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">pswd</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

    <span class="n">window</span><span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
    <span class="n">start</span><span class="o">=</span> <span class="n">App</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">user</span><span class="p">,</span><span class="n">pswd</span><span class="p">,</span><span class="n">db</span><span class="p">)</span>
    <span class="n">window</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
</code></pre>
</div>

<h1 id="a-namesavinga-saving-data-with-our-gui"><a name="saving"></a> Saving data with our GUI</h1>

<p>Now that our GUI has a functional query panel, we’d like to let our users save the data to a local csv file.  We can set up the layout of our “saving panel” using the same methods that we did for our query panel.  Within the <code class="highlighter-rouge">App</code> class’ <code class="highlighter-rouge">__init__</code> method, we add the following code:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>        <span class="s">'''Saving Panel'''</span>  
        <span class="c">#Line to separate panels</span>
        <span class="n">canvas</span> <span class="o">=</span> <span class="n">Canvas</span><span class="p">(</span><span class="n">master</span><span class="o">=</span><span class="n">window</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
        <span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s">"black"</span><span class="p">)</span>
        <span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="c">#Label for Entry box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_label</span> <span class="o">=</span> <span class="n">Label</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span> <span class="s">"Save Location: "</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>          
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span> 
		     
        <span class="c">#Entry box for save location  </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_text</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">save_button</span> <span class="o">=</span> <span class="n">Button</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">"Save Data"</span><span class="p">)</span>
        <span class="c">#self.save_button.configure(command=self.save_to_csv)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre>
</div>

<p>The only unfamiliar piece of the code above is the first six lines.  These lines use Tkinter’s <code class="highlighter-rouge">Canvas</code> and <code class="highlighter-rouge">create_line</code> methods to draw a solid black line that separates the saving panel from the query panel.  The canvas is positioned using the <code class="highlighter-rouge">grid</code> method that we are already familiar with.</p>

<p>If we run the main program at this point, the GUI will look like this:</p>

<p><img src="https://raw.githubusercontent.com/Raknoche/Raknoche.github.io/master/_posts/Images/GUI_SavingPanel.png" alt="png" /></p>

<p>Now we need to write the <code class="highlighter-rouge">self.save_to_csv</code> method that corresponds to the button we just added.  We define this new method within the <code class="highlighter-rouge">App</code> class, and use the familiar <code class="highlighter-rouge">get()</code> method from Tkinter to obtain the save location from the entry box we just created.  We’ll need to check that the directory specified in the save path exists, and that the path ends with an appropriate <code class="highlighter-rouge">filename.csv</code> filename.  We should also verify that the data frame is not empty, since we can not save data that doesn’t exist.  Once we have an appropriate save location, Pandas provides a convenient <code class="highlighter-rouge">to_csv</code> method to save the data frame to a csv file.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>    <span class="k">def</span> <span class="nf">save_to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#Verify that the data frame is not empty</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
             <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Save Error'</span><span class="p">,</span> <span class="s">'Error: Can not save empty data frame'</span><span class="p">)</span>

        <span class="c">#If we have data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Get the save location and extract the directory path</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_text</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_loc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="c">#Verify that the directory exists</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span><span class="p">):</span>

                <span class="c">#Verify that the filename is more than just '.csv'</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_loc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Save Error'</span><span class="p">,</span> <span class="s">'Error: Path should end in filename.csv'</span><span class="p">)</span>

                <span class="c">#Verify that the filename ends in '.csv'</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_loc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">!=</span> <span class="s">'.csv'</span><span class="p">:</span>
                    <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Save Error'</span><span class="p">,</span> <span class="s">'Error: File should end in filename.csv'</span><span class="p">)</span>

                <span class="c">#Save the data if it passes error checking</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_loc</span><span class="p">)</span>
                    
            <span class="c">#Error if the directory doesn't exist        </span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Save Error'</span><span class="p">,</span> <span class="s">'Error: File directory does not exist'</span><span class="p">)</span>
</code></pre>
</div>

<p>After uncommenting the line which assigns functionality to the save button, our final GUI code looks like this:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">pymysql</span> <span class="kn">as</span> <span class="nn">mdb</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">messagebox</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">class</span> <span class="nc">App</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">user</span><span class="p">,</span><span class="n">pswd</span><span class="p">,</span><span class="n">db</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="o">=</span><span class="n">ip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">=</span><span class="n">user</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pswd</span><span class="o">=</span><span class="n">pswd</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">=</span><span class="n">db</span>

        <span class="c">#Set the window title </span>
        <span class="n">window</span><span class="o">.</span><span class="n">wm_title</span><span class="p">(</span><span class="s">"Database Interface"</span><span class="p">)</span>

        <span class="c">#Set the current row to zero</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="o">=</span><span class="mi">0</span>

        <span class="s">'''Query Panel'''</span>
        <span class="c">#Run tag field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_label</span> <span class="o">=</span> <span class="n">Label</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span> <span class="s">"Run Tag: "</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_text</span>  <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtag_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtag_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c">#Start time field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_label</span> <span class="o">=</span> <span class="n">Label</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span> <span class="s">"Start Time (YYYY-MM-DD HH:MM:SS): "</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>          
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_text</span>  <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">start_t_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_t_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span>  <span class="o">+=</span> <span class="mi">1</span>

        <span class="c">#End time field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_label</span> <span class="o">=</span> <span class="n">Label</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span> <span class="s">"End Time (YYYY-MM-DD HH:MM:SS): "</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>          
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_text</span>  <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end_t_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_t_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>     

        <span class="c">#Send Query button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query_button</span> <span class="o">=</span> <span class="n">Button</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">"Send Query"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query_button</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sendQuery</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c">#Query status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">querystatus</span>  <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">''</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">querystatus</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="s">'''Saving Panel'''</span>  
        <span class="c">#Line to separate panels</span>
        <span class="n">canvas</span> <span class="o">=</span> <span class="n">Canvas</span><span class="p">(</span><span class="n">master</span><span class="o">=</span><span class="n">window</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
        <span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s">"black"</span><span class="p">)</span>
        <span class="n">canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>
		    
        <span class="c">#Label for Entry box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_label</span> <span class="o">=</span> <span class="n">Label</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span> <span class="s">"Save Location: "</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>          
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span> 
		     
        <span class="c">#Entry box for save location  </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_text</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">save_button</span> <span class="o">=</span> <span class="n">Button</span> <span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">"Save Data"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_button</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_to_csv</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_row</span> <span class="o">+=</span> <span class="mi">1</span>


    <span class="k">def</span> <span class="nf">sendQuery</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">start_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_t_text</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">end_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_t_text</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">run_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtag_text</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

        <span class="c">#Check that date is valid</span>
        <span class="n">time_format</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'^</span><span class="err">\</span><span class="s">d{4}-</span><span class="err">\</span><span class="s">d{2}-</span><span class="err">\</span><span class="s">d{2} </span><span class="err">\</span><span class="s">d{2}:</span><span class="err">\</span><span class="s">d{2}:</span><span class="err">\</span><span class="s">d{2}$'</span><span class="p">)</span>
        <span class="n">start_t_okay</span><span class="o">=</span><span class="bp">None</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">start_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time_format</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">start_t</span><span class="p">)):</span>
            <span class="n">start_year</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">start_month</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span>
            <span class="n">start_day</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
            <span class="n">start_hour</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">13</span><span class="p">])</span>
            <span class="n">start_min</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">16</span><span class="p">])</span>
            <span class="n">start_sec</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">start_t</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">19</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span><span class="n">start_month</span><span class="p">,</span><span class="n">start_day</span><span class="p">,</span><span class="n">start_hour</span><span class="p">,</span><span class="n">start_min</span><span class="p">,</span><span class="n">start_sec</span><span class="p">)</span>
                <span class="n">start_t_okay</span><span class="o">=</span><span class="s">'yes'</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">start_t_okay</span><span class="o">=</span><span class="s">'no'</span>


        <span class="n">end_t_okay</span><span class="o">=</span><span class="bp">None</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">end_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time_format</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">end_t</span><span class="p">)):</span>
            <span class="n">end_year</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">end_month</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span>
            <span class="n">end_day</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
            <span class="n">end_hour</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">13</span><span class="p">])</span>
            <span class="n">end_min</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">16</span><span class="p">])</span>
            <span class="n">end_sec</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">end_t</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">19</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">end_year</span><span class="p">,</span><span class="n">end_month</span><span class="p">,</span><span class="n">end_day</span><span class="p">,</span><span class="n">end_hour</span><span class="p">,</span><span class="n">end_min</span><span class="p">,</span><span class="n">end_sec</span><span class="p">)</span>
                <span class="n">end_t_okay</span><span class="o">=</span><span class="s">'yes'</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">end_t_okay</span><span class="o">=</span><span class="s">'no'</span>        

        <span class="s">'''Error Handling'''</span>
        <span class="c">#Check that the date is in the correct format</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">start_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">time_format</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">start_t</span><span class="p">)):</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Error: Start time Must have the format "YYYY-MM-DD HH:MM:SS" or be empty'</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">end_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">time_format</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">end_t</span><span class="p">)):</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Error: End time Must have the format "YYYY-MM-DD HH:MM:SS" or be empty'</span><span class="p">)</span>
        <span class="c">#Check that the date is a valid date</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">start_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">start_t_okay</span> <span class="o">==</span> <span class="s">'no'</span><span class="p">):</span>        
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Error: Start time is not valid'</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">end_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_t_okay</span> <span class="o">==</span> <span class="s">'no'</span><span class="p">):</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Error: End time is not valid'</span><span class="p">)</span>
        <span class="c">#Check that start_t &lt; end_t</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">start_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">start_t</span> <span class="o">&gt;</span> <span class="n">end_t</span><span class="p">):</span>         
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Error'</span><span class="p">,</span> <span class="s">'Start time must come before end time'</span><span class="p">)</span>    
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Default to not including the conditions in the query</span>
            <span class="n">run_tag_string</span> <span class="o">=</span> <span class="s">''</span>
            <span class="n">time_string</span> <span class="o">=</span> <span class="s">''</span>

            <span class="c">#Toggle query conditions on if the GUI field isn't blank</span>

            <span class="c">#Run tag condition</span>
            <span class="k">if</span> <span class="n">run_tag</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
                <span class="n">run_tag_string</span> <span class="o">=</span> <span class="s">'AND run_tag = "</span><span class="si">%</span><span class="s">s"'</span> <span class="o">%</span><span class="p">(</span><span class="n">run_tag</span><span class="p">)</span>
    		    
            <span class="c">#Time window condition (in order: both set, only start set, only end set)</span>
            <span class="k">if</span> <span class="n">start_t</span> <span class="o">!=</span> <span class="s">''</span> <span class="ow">and</span> <span class="n">end_t</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
                <span class="n">time_string</span> <span class="o">=</span> <span class="s">'AND clock_time BETWEEN "</span><span class="si">%</span><span class="s">s" AND "</span><span class="si">%</span><span class="s">s"'</span> <span class="o">%</span><span class="p">(</span><span class="n">start_t</span><span class="p">,</span><span class="n">end_t</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">start_t</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
                <span class="n">time_string</span> <span class="o">=</span> <span class="s">'AND clock_time &gt; "</span><span class="si">%</span><span class="s">s"'</span> <span class="o">%</span><span class="p">(</span><span class="n">start_t</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">end_t</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
                <span class="n">time_string</span> <span class="o">=</span> <span class="s">'AND clock_time &lt; "</span><span class="si">%</span><span class="s">s"'</span> <span class="o">%</span><span class="p">(</span><span class="n">end_t</span><span class="p">)</span>           
    		                
            <span class="c">#Setting the query</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="s">"SELECT clock_time, amplitude FROM summarydata WHERE amplitude IS NOT NULL </span><span class="si">%</span><span class="s">s </span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">run_tag_string</span><span class="p">,</span> <span class="n">time_string</span><span class="p">)</span>

            <span class="n">con</span> <span class="o">=</span> <span class="n">mdb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pswd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="p">);</span>

            <span class="k">with</span> <span class="n">con</span><span class="p">:</span>
                <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

                <span class="c">#Send select statement</span>
                <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">)</span>

                <span class="c">#Fetch the data from our query</span>
                <span class="n">rows</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

                <span class="c">#Fill a pandas data frame with timestamps and amplitude info</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timetuple</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">))]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s">'amplitude'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">))]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">querystatus</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s">"Finished"</span><span class="p">)</span>

            <span class="c">#Check if the query returned data</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                 <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Query Warning'</span><span class="p">,</span> <span class="s">'Warning: Query returned no data'</span><span class="p">)</span>
           


    <span class="k">def</span> <span class="nf">save_to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#Verify that the data frame is not empty</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
             <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Save Error'</span><span class="p">,</span> <span class="s">'Error: Can not save empty data frame'</span><span class="p">)</span>

        <span class="c">#If we have data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Get the save location and extract the directory path</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_text</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_loc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="c">#Verify that the directory exists</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span><span class="p">):</span>

                <span class="c">#Verify that the filename is more than just '.csv'</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_loc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Save Error'</span><span class="p">,</span> <span class="s">'Error: Path should end in filename.csv'</span><span class="p">)</span>

                <span class="c">#Verify that the filename ends in '.csv'</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_loc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">!=</span> <span class="s">'.csv'</span><span class="p">:</span>
                    <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Save Error'</span><span class="p">,</span> <span class="s">'Error: File should end in filename.csv'</span><span class="p">)</span>

                <span class="c">#Save the data if it passes error checking</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_loc</span><span class="p">)</span>
                    
            <span class="c">#Error if the directory doesn't exist        </span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s">'Save Error'</span><span class="p">,</span> <span class="s">'Error: File directory does not exist'</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="s">'''
    Usage: python radonGUI.py databaseIP username password databaseTable
    '''</span>
    <span class="n">ip</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">pswd</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

    <span class="n">window</span><span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
    <span class="n">start</span><span class="o">=</span> <span class="n">App</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">user</span><span class="p">,</span><span class="n">pswd</span><span class="p">,</span><span class="n">db</span><span class="p">)</span>
    <span class="n">window</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
</code></pre>
</div>

<h1 id="closing-remarks">Closing remarks</h1>

<p>The GUI we built in this post is a simplified version of the code I wrote for our new undergraduate students.  The complete GUI includes advanced functionality, such as the ability to change the units of our timestamps, plot the data in multiple ways at the push of a button, and select and delete data from those plots before saving the csv file.  These functions won’t be applicable to everybody who reads this post, as they are tuned to the specific type of data my GUI collects.  If you’d like to learn how to implement similar functionality, feel free to look at the <a href="https://github.com/Raknoche/MyCode/blob/master/CodeForDealingData/radonGUI.py">complete code</a> on my Github page and ask any questions you may have here.</p>

  
  </div>
</div>


<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<div class="social-media">
    Share this: 
    <a class="social-media-box" href="https://twitter.com/intent/tweet?text=Making a MySQL GUI with Tkinter&url=http://www.dealingdata.net/2016/08/21/Python-MySQL-GUI/&via=&related=" rel="nofollow" target="_blank" title="Share on Twitter"><i class="fa fa-twitter fa-sm-90"></i>Twitter</a>
    <a class="social-media-box" href="https://facebook.com/sharer.php?u=http://www.dealingdata.net/2016/08/21/Python-MySQL-GUI/" rel="nofollow" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-f fa-sm-90"></i>Facebook</a>
    <a class="social-media-box" href="https://plus.google.com/share?url=http://www.dealingdata.net/2016/08/21/Python-MySQL-GUI/" rel="nofollow" target="_blank" title="Share on Google+"><i class="fa fa-google-plus fa-sm-90"></i>Google+</a>
</div>


<div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    
    
    var disqus_config = function () {
        this.page.url = "http://dealingdata.net/2016/08/21/Python-MySQL-GUI/";  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = "dealingdata.net/2016/08/21/Python-MySQL-GUI/"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        
        s.src = '//dealingdata.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


                                  

      </div>
    </div>



  </body>
</html>
